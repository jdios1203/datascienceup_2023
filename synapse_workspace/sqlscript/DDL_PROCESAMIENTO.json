{
	"name": "DDL_PROCESAMIENTO",
	"properties": {
		"content": {
			"query": "SELECT YEAR(Fecha)'Año',UPPER(D.RETAIL)'RETAIL',RTRIM(SKU)'COD_CADENA', NRO_LOCAL'COD_LOCAL',UPPER(DATENAME(month,Fecha))'MES',\nDATEPART(week,Fecha)'SEM', CONVERT(DECIMAL,Unidades)*CONVERT(DECIMAL,B.[PREC_UNITARIO]) 'VTA_PERIODO_NETA(S/)',Unidades'VTA_PERIODO(U)',\nCONVERT(DECIMAL,C.STOCK_CONTABLE)*CONVERT(DECIMAL,C.[PU_CONTABLE])'INVENTARIO(S/)',C.STOCK_CONTABLE'INVENTARIO(U)',Fecha\nFROM business.unidades01 A INNER JOIN business.precio B ON A.[COD_REF]=B.[COD_REF] INNER JOIN business.stock C \nON A.[COD_REF]=C.[COD_REF]\nINNER JOIN business.TiendasRetail D ON A.NRO_LOCAL=D.COD_LOCAL\n\n\nSELECT CAST(Unidades as DECIMAL)*CAST(B.[PREC_UNITARIO] as DECIMAL) 'VTA_PERIODO_NETA(S/)'\nFROM business.unidades01 A INNER JOIN business.precio B ON A.[COD_REF]=B.[COD_REF] INNER JOIN business.stock C \nON A.[COD_REF]=C.[COD_REF]\nINNER JOIN business.TiendasRetail D ON A.NRO_LOCAL=D.COD_LOCAL\n\nSELECT \n    YEAR(Fecha) AS 'Año',\n    UPPER(D.RETAIL) AS 'RETAIL',\n    RTRIM(SKU) AS 'COD_CADENA',\n    NRO_LOCAL AS 'COD_LOCAL',\n    UPPER(DATENAME(month, Fecha)) AS 'MES',\n    DATEPART(week, Fecha) AS 'SEM',\n    TRY_CAST(Unidades AS DECIMAL) * TRY_CAST(B.[PREC_UNITARIO] AS DECIMAL) AS 'VTA_PERIODO_NETA(S/)',\n    Unidades AS 'VTA_PERIODO(U)',\n    TRY_CAST(C.STOCK_CONTABLE AS DECIMAL) * TRY_CAST(C.[PU_CONTABLE] AS DECIMAL) AS 'INVENTARIO(S/)',\n    C.STOCK_CONTABLE AS 'INVENTARIO(U)',\n    Fecha\nFROM \n    business.unidades01 A \nINNER JOIN \n    business.precio B ON A.[COD_REF] = B.[COD_REF] \nINNER JOIN \n    business.stock C ON A.[COD_REF] = C.[COD_REF]\nINNER JOIN \n    business.TiendasRetail D ON A.NRO_LOCAL = D.COD_LOCAL",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "updatawarehouse",
				"poolName": "Built-in"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}